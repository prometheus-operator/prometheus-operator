# Strategic merge patch

When users need to apply a specific configuration to containers that we do not support or do not currently exist, merge patch can be used.
This document describes how to overwrite the container configuration generated by the operator by merging patches.

## How the "strategic merge patch" works
	
Operator support `containers` field in `PrometheusSpec` and `AlertmanagerSpec` configuration.
This field allows injecting additional containers, and the existing configuration can be overwritten by sharing the same container name.

### Merge patch Prometheus example

The following is an example on how to overwrite Prometheus container `readinessProbe`  `FailureThreshold` configuration.

```
apiVersion: monitoring.coreos.com/v1
kind: Prometheus
metadata:
  labels:
    prometheus: self
  name: self
  namespace: default
spec:
  containers:
  - name: prometheus
    readinessProbe
      failureThreshold: 500
```

### Merge patch alertmanager example

Overwrite alertmanager container readinessProbe  `FailureThreshold` configuration.

```
apiVersion: monitoring.coreos.com/v1
kind: Alertmanager
metadata:
  labels:
    alertmanager: main
  name: main
  namespace: monitoring
spec:
  containers:
  - name: alertmanager
    livenessProbe:
      failureThreshold: 5
    readinessProbe
      failureThreshold: 5
```
