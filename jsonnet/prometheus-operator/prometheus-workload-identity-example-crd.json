{
  "apiVersion": "monitoring.coreos.com/v1",
  "kind": "Prometheus",
  "metadata": {
    "name": "prometheus-azure-workload-identity",
    "namespace": "monitoring"
  },
  "spec": {
    "image": "prom/prometheus:v3.7.0",
    "remoteWrite": [
      {
        "azuread": {
          "cloud": "AzurePublic",
          "workloadIdentity": {
            "clientId": "yyyyyyyy-yyyy-yyyy-yyyy-yyyyyyyyyyyy",
            "tenantId": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
          }
        },
        "url": "https://example.azuremonitor.com/metrics/write",
        "writeRelabelConfigs": [
          {
            "action": "drop",
            "regex": "prometheus_.*",
            "sourceLabels": [
              "__name__"
            ]
          }
        ]
      }
    ],
    "replicas": 2,
    "serviceAccountName": "prometheus",
    "serviceMonitorSelectorNilUsesHelmValues": false,
    "storage": {
      "tsdb": {
        "outOfOrderTimeWindow": "30m"
      }
    }
  }
}
